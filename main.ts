namespace SpriteKind {
    export const setDressing = SpriteKind.create()
    export const yellowFish = SpriteKind.create()
    export const orangeFish = SpriteKind.create()
}
/**
 * Wiring:
 * 
 * PyGamer
 * 
 * Rotary encoder to GND, A3, A2, D9 (button)
 */
sprites.onOverlap(SpriteKind.Player, SpriteKind.orangeFish, function (sprite, otherSprite) {
    if (!(hooked) && !(caught)) {
        otherSprite.destroy()
        hooked = true
        caught = true
        // use for reeling speed challenge
        fightCounter = 0
        fishColor = 0
    }
})
// This happens when the fish is reeled in, at the top of screen it's "destroyed", but this is a good thing!
sprites.onDestroyed(SpriteKind.Food, function (sprite) {
    caught = false
    triggered = false
    cast = false
    if (gotAway) {
        music.powerDown.play()
        game.splash("That one got away.")
        info.changeLifeBy(-1)
    } else {
        if (fishColor == 0) {
            info.changeScoreBy(1)
        } else {
            info.changeScoreBy(2)
        }
        music.baDing.play()
        game.showLongText("You caught it!" + "This one weighs " + convertToText(randint(2, 18)) + " lbs." + " Nice!!", DialogLayout.Center)
    }
    hook.y = -45
    line.y = hook.y
    hook.x = 80
    line.x = hook.x
})
// Stops the throw, locking the reel, making the hook drop.
controller.down.onEvent(ControllerButtonEvent.Released, function () {
    if (thrown) {
        thrown = false
        cast = true
        // Add slight offset.
        hook.x += randint(-10, 10)
        line.x = hook.x
        triggered = false
        hook.setImage(img`
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ............c...
            ............cc..
            ...........c.c..
            ...........cc...
            ..........c.....
            ..........c.....
            ...c.....c......
            ..cc.....c......
            cc.c.....c......
            c..c....c.......
            c.......c.......
            c......c........
            c.....cc........
            .ccccc..........
            ................
            ................
            ................
            `)
        line.setImage(img`
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ............c...
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            `)
        music.playTone(698, music.beat(BeatFraction.Eighth))
    }
})
// Hold trigger to prep to cast the line by shaking the PyGamer.
controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
    if (!(cast)) {
        triggered = true
        prevCrank = controller.crankPosition()
        line.setImage(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `)
        hook.setImage(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `)
        music.playTone(175, music.beat(BeatFraction.Quarter))
    }
})
function spawnFishLeft () {
    if (Math.percentChance(10)) {
        fishLeft = sprites.createProjectileFromSide(img`
            . . . . . . . . . . . . . . . . 
            . . . . 4 4 4 4 4 4 4 4 . . . . 
            4 . . . 4 4 4 4 4 4 4 4 4 4 4 . 
            4 4 . 4 4 4 4 4 4 4 4 1 4 4 4 4 
            4 4 . 4 4 4 4 4 4 4 4 1 1 f 4 4 
            4 4 . 4 4 4 4 4 4 4 4 1 1 f 4 4 
            4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 
            4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 
            4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 
            4 4 4 4 4 4 4 4 4 4 4 f 4 4 4 4 
            4 4 4 4 4 4 4 4 4 4 4 f f 4 4 4 
            4 4 . 4 4 4 4 4 4 4 4 4 f f f f 
            4 4 . 4 4 4 4 4 4 4 4 4 4 4 4 4 
            4 . . . 4 4 4 4 4 4 4 4 4 4 4 . 
            . . . . 4 4 4 4 4 4 4 4 . . . . 
            . . . . . . . . . . . . . . . . 
            `, randint(6, 12), 0)
        fishLeft.setKind(SpriteKind.orangeFish)
        if (Math.percentChance(50)) {
            fishLeft.y = randint(85, 90)
        } else {
            fishLeft.y = randint(115, 120)
        }
    }
}
function spawnFishRight () {
    if (Math.percentChance(10)) {
        fishRight = sprites.createProjectileFromSide(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . 5 5 5 . . . . . . . . . . 
            . 5 5 5 5 5 5 . . . . . . . . . 
            5 f f 1 5 5 5 5 5 . . . 5 5 . . 
            5 5 f 1 5 5 5 5 5 5 5 5 5 5 . . 
            5 5 5 5 5 5 5 5 5 5 5 5 5 . . . 
            5 5 5 5 5 5 5 5 5 5 5 5 5 . . . 
            f f f 5 5 5 5 5 5 5 5 5 5 . . . 
            f f 5 5 5 5 5 5 5 5 5 5 5 . . . 
            5 5 5 5 5 5 5 5 5 5 5 5 5 5 . . 
            5 5 5 5 5 5 5 5 5 . . . 5 5 5 . 
            . . . 5 5 5 5 . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, randint(-6, -12), 0)
        fishRight.setKind(SpriteKind.yellowFish)
        fishRight.y = randint(100, 105)
    }
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.yellowFish, function (sprite, otherSprite) {
    if (!(hooked) && !(caught)) {
        otherSprite.destroy()
        hooked = true
        caught = true
        // use for reeling speed challenge
        fightCounter = 0
        fishColor = 1
    }
})
// Casts the line by holding down button and shaking PyGamer.
controller.onGesture(ControllerGesture.Shake, function () {
    if (triggered) {
        thrown = true
        music.playTone(880, music.beat(BeatFraction.Half))
    }
})
let thisRound = ""
let lastCrank = 0
let change = 0
let hookedFish: Sprite = null
let crankScaling = 0
let fishRight: Sprite = null
let fishLeft: Sprite = null
let prevCrank = 0
let thrown = false
let gotAway = false
let fishColor = 0
let fightCounter = 0
let caught = false
let line: Sprite = null
let hook: Sprite = null
let hooked = false
let cast = false
let triggered = false
game.splash("Gone Fishing!")
game.showLongText("To cast, 1) hold \"down\" button, 2) shake PyGamer, 3) release \"down\" button", DialogLayout.Full)
game.showLongText("When you hook a fish,   reel it in at a medium speed. It'll tell you if it's too fast or too slow! ", DialogLayout.Full)
game.showLongText("Click the reel button to move line side to side.", DialogLayout.Full)
controller.setCrankPins(pins.A3, pins.A2)
pins.D9.setPull(PinPullMode.PullUp)
triggered = false
cast = false
hooked = false
scene.setBackgroundImage(img`
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999995555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999995555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999955555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999111111999999999999999999995555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999199111111119999999999999999995555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999991111991111111111999999999999999999555555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999911111911111111111199999999999999999955555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999991111111111111111111199999999999999999995555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999991111111111111111111111199999999999999999999555555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999111111111111111111111111111199999999999999999999995555555555
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999111111119999911111111111111111999999999999999999999999999955555
    9999999999999999999999999999999111111199999999999999999999999999999999999999999999999999999999111111199999111111111111111111119999999999999999999999999999999999
    9999999999999999999999999999911111111119999999999999999999999999999999999999999999999999999911999999991111111111111111111999999999999999999999999999999999999999
    9999999999999999999999999999911111111119911119999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999911111199911111111119111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999111111111111111111119111111119999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999991111111111191111111111111111111999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999911111111111111111111111111111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999911111111111111111111111111111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999911111111111111111111111111111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999991111111111111111111111111111111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999991111111111111111111111111111111111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999991111111111111111111111111111111111999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999991111111111111111111111999911111199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999777777799999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999997777777777777799999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    99999999997ee7e777777777777c999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999997999999999999999999
    99999997777777ee777777777777799999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999997999999999999999999
    99999977777e7777c77ccc777777777799999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999979999999999999999999
    99999777eeed7e7e777777ccee77777777997999999997999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999979999999999999999999
    99999776eee7777777777777ee7ede7777797999997997999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999799997999799999999999999
    999997667e77e7de777777777777eed77779799dd77dd7d99999799999999999999999999999999999999999999999999999999999999999999999999999999999999999799997999779999999999999
    999e7eee777d7ede777c777777ee7777777777ddddddd7dddd9979999999999999999999999999999999999999999999999999999999999999999999999999999999dddd7ddd97999979999999999999
    9699e7e7e777eee7777d7cd77e77777777dcc7dddddcd7dd77dd799999999999999999999999999999999999999999999999999999999999999999999999999dd7ddddddd7ddddd99979999999999999
    9669e7e7d7eeedeeeee7dd7777ddddddd7d66c7ddd6ddddd77d677dd999999999999999999999999999999999999999999999999999999999999999999d7ddddd7ddddddd7dddddddd79997999999999
    9d77777e77eddeddeddddddddd7d7dddd6d6dd7dcc6ddddd7dd677ddddd9999999999999999999999999999999999999999999999999999999999dddddd7ddddd7ddddddd7ddcddddddddd7999977999
    9d7e77777eddddddeeedddd7dd7dd7ddd6d6dd7ddd6ddddd7d6c77dddddddd99999999999999999999999999999999999999999999999999ddddddddddd7ddddd77ddddcd7ddcdddd6ddd7ddd9997999
    9777e7eeedeeeeddddedddd7dd7dd77dd7dddd7ddd6cddcd7c6d7ddddddd7dddd999999999999999999999999999999999999999999dddddddddddddddddccdd7dddddddd6ddddddd6ddd7dddd7d7999
    977e7ddeeddeddeeeeeddd66ddddd6d67ddddd76776d7ddd6ddddccddddd7d77dddd9999999999999999999999999999999999dddddddddddddddddddd7ddd7d7ddcdddd776dddddd6dd67d6dd7ddddd
    97d7dddddddddddddddcd7d6dcddd6d77ddddd6776677d6d6dd7dddddcdd7dd7ddddddd99999999999999999999999999ddddddddddddddddddddddddd7ddd666dddddc6d76dd66d7dddd7d6d7dddddd
    dd7ddddddddddddd7ddd7d7ddd7d76d7d7d7dd6c77c7dd6dddd7ddddd7dd7dd7dddddddddd99999999999999999dddddddddddddddddddddddddddd66d7dddcd6666ddd6dddddcc67dddd7d6d66ddddd
    dddddddddddddddd7ddd7d7ddd7d7dd7d7dd7ddd7ddc7d6cddddddd7d7cdd7dddddccdddddddd999999999dddddddddddddddddcddddddcdccdd76c7767d7ddd6d66cd67ddccd6d67dddd7cdc7dddddd
    ddddddcddd7dd7dccdc77d7dcddd7ddd77dd7dcd7cdd7d6ddddcddd7d7ddd7ddddddddcdddddddeedddddddddddddddd7dddddd7dddddddddddd76dd767d7ddddd66dd67dddd6d767c7d7cddd7dcdddd
    ddddd7ddc7ddd6ddddd7dddddddddddd777d7ddd7ddddd6dddddddc7ddddd7ddccddddd7dddddddddddddddddccddddc7dcdddd7dcdddddddddd7cdd7c6d7dddddd6ddd7dddd6d7d7d7d7dddd7ddcddd
    ddcdd7ddd7ddd6dddd7d7cddcdddddddd77d7dddd7dddddddd77ddd7dcdc777ddddcddd7ddddddddddeeddcddddddddcd7ddddd7dcddddcdddddddddcddd7dddddddcd77dddddd7ddd7ddddddddddddd
    ddddd7dcc7ddd6dd6d7dd7dddddccdddd77dddcdd7dcddddddd7ddddddd7d77ddccddddd7dddddddd7dddddddd7dddddd7dddddd7ddd7dddddddddddddd6ddddddddd7dddddddd7ddd7ddddddddddccd
    ddddc7ddcddcd7ddd6ddd7dddcddddddd77dddddd7dddddccdd7cddddd7cd77ddcdddddcddd7ccddd7dddedddd7dddddd7ddccdddddd77cddddddddddcd6dcdddddd7dddddcdddcddd7dddddccdddddd
    ddddd7dddddd77ddddddd7ddddddddddddddddcdd7ddddddddddddddcd7cd77ddddddcddddc7dddddd7dddddddd7dcdddcddddddcdddd7dd7ddcdcddddd6dcdddddd7dddddddddddddddcdddddcdddcd
    ddddd7ccdcdcdcddcddddddddddddddddddddddddddddddd77dddddddd7ddd7ddddddcddddd77dcddd7ddddeeeddddddddddddddddddccdcd7dd7dddddc6dcdddddd7ddddddcddddddddcddddddcdddd
    dddddddddddddddddddddccd777cdddddddddddddddddddd77dddddddd7cdd7ddddddddddddd7ccdddcddddddedddddddddcddddddddddcddddd7dddddc6ddcdddcd7ddddddddddddcdddddddddddddd
    ddddddcddddddddddddddddd7d7ddddddddddddddcdddddd77dddcdddd7ddddcdddcdddddcdddddddddddddcdddddddddddddddddddddddddddc7dddcddcdcddddd77ddddddddddddddddddddddddddd
    ddddddcddddddddcddddcddd7dddddddddddddddcddddddddddddddddddddddddddcddddcdddcddddcdddddddddeedddddddddddddcddddddddddddddddddddcddddddddddcddcdddcdddddddddddddd
    ddddddddddccdddddddddddd7ddcddddddddddcddddddcddddddddddddddddddddddddddcddddddddddddddddddddddddddddddddddccdddddddddddddddddddcddddddddddddddddcdddddcdddddddd
    ddddcddddddddddddddddddddddddccddcdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddeeddddddddddddddddddddc7ddddddddddddcdddddddddddddddddddddddddddddd
    ddddddddcdcdddddddcdddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddeddddddddddddddddddddd7ddddddddddddddddddddddddddddddddddddddddddd
    ddddddcddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddcdddddddddddddddddddddddddddddd7dcdddddddddddddddddddddcddddcdddddddddddddd
    ddddddddddddddddddddddddddddddddddddddddddcddddd898dddddddddddddddddddddddddddddddddddddddddddddddeeddddddddddddddddddddddddddcddddcdddddddddddccddddddddddddddd
    ddddddddddddddddddddddddddddddddddddddddddddddd989898ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
    ddddddddddddddddddddddddddddddddddddddddddddddd898989ddddddd898dddddddddddddddddddddddddddddddddddddeddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
    ddddddddddddddddddddddddddddddd8dddddddddddddd898989898989898989898989dddddddddddddddddddd8989898989ddddddddddddddddddddddddddddddddddddddcddddddddddddddddddddd
    dddddddddddd998dddddddddddddd989898dddddddddd98989898989898989898989898989898989898989898989898989898ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
    dddddddd89898989898dddddddd89898989898ddddddd8989898989898989898989898989898989898989898989898989898989ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
    dddd9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898dddddddddddddddddddddddddddddddddddddddddddddddddddddddd
    989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898988dddddddddddddddddddddddddddddddddddddddddd9898989898989
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989ddddddddddddddddddddddddddddddddddddd89898989898989898
    989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898ddddddddddddddddddddddddddddddd989898989898989898989
    9989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989888dddddddddddddddddddddddd998989898989898989898989898
    989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898988dddddddddddddddddddddd989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    9898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898
    8989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989898989
    `)
// Acts like a fake alpha channel of semi-transparent water overlay.
let waterLayer = sprites.create(img`
    ................................................................................................................................................................
    .................9..............................................................................................................................................
    ......9.........9.9.......................9.9.9.9.9...................9...........9.9.9.9.9.9.9...........................9.....................................
    .....9.9.......9.9.9.9...............9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.......9.9.9.9.9.9.........................9.9
    ....9.9.9.9.9.9.9.9.9.9.9.9...........9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.................9.9.9.9.9.
    ...9.9.9.9.9.9.9.9.9.9.9.9.9.........9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9...............9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.......9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9...........9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.........9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    .9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9
    9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.9.
    `, SpriteKind.setDressing)
waterLayer.setPosition(80, 104)
waterLayer.z = 2
hook = sprites.create(img`
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ............c...
    ............cc..
    ...........c.c..
    ...........cc...
    ..........c.....
    ..........c.....
    ...c.....c......
    ..cc.....c......
    cc.c.....c......
    c..c....c.......
    c.......c.......
    c......c........
    c.....cc........
    .ccccc..........
    ................
    ................
    ................
    `, SpriteKind.Player)
hook.setPosition(77, 26)
hook.z = 4
line = sprites.create(img`
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ............c...
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    ................
    `, SpriteKind.setDressing)
line.setPosition(77, 26)
line.z = 3
info.setLife(5)
// Reposition pre-cast line on x.
game.onUpdate(function () {
    if (!(pins.D9.digitalRead())) {
        hook.x = randint(30, 130)
        line.x = hook.x
        pause(350)
    }
})
game.onUpdateInterval(2000, function () {
    spawnFishRight()
})
game.onUpdateInterval(1000, function () {
    spawnFishLeft()
})
// When a line is cast, allows rotary encoder crank to control hook (and line) position, turns swimming fish into hooked fish.
forever(function () {
    if (!(cast)) {
        hook.y = -45
        line.y = hook.y
    }
    if (cast) {
        // makes the player have to crank many more revolutions per pixel of vertical gain.
        crankScaling = 4
        hook.y = (controller.crankPosition() - prevCrank) / crankScaling + 45
        line.y = hook.y
    }
    if (hooked && caught) {
        if (fishColor == 0) {
            hookedFish = sprites.create(img`
                . . . . . 4 4 4 4 4 . . . . . . 
                . . . . 4 4 4 4 4 4 4 4 . . . . 
                . . . . 4 4 4 4 4 f 4 f 4 . . . 
                . . . 4 4 4 4 4 4 4 f 4 4 4 . . 
                . . . 4 4 4 4 4 4 f 4 f 4 4 . . 
                . . . 4 4 4 4 4 4 4 4 4 4 4 . . 
                . 4 4 4 4 4 4 4 4 4 4 4 4 4 . . 
                . 4 4 4 4 4 4 4 4 4 4 4 4 4 . . 
                . 4 4 4 4 4 4 4 4 4 4 4 4 4 . . 
                . . . 4 4 4 4 4 4 4 4 4 4 4 . . 
                . . . 4 4 4 4 4 4 4 4 4 4 . . . 
                . . . . 4 4 4 4 4 4 4 4 . . . . 
                . . . . . 4 4 4 4 4 4 . . . . . 
                . . . . . 4 4 4 4 4 . . . . . . 
                . . . . 4 4 4 4 4 4 . . . . . . 
                . . . 4 4 4 4 4 4 4 4 4 . . . . 
                `, SpriteKind.Food)
            hooked = false
        } else {
            hookedFish = sprites.create(img`
                . . . . . . 5 5 5 5 5 . . . . . 
                . . . . . 5 5 5 5 5 5 5 . . . . 
                . . . . 5 5 f 5 f 5 5 5 5 . . . 
                . . . 5 5 5 5 f 5 5 5 5 5 . . . 
                . . . 5 5 5 f 5 f 5 5 5 5 5 . . 
                . . . 5 5 5 5 5 5 5 5 5 5 5 . . 
                . . . 5 5 5 5 5 5 5 5 5 5 5 . . 
                . . . 5 5 5 5 5 5 5 5 5 5 5 . . 
                . . . 5 5 5 5 5 5 5 5 5 5 5 . . 
                . . . 5 5 5 5 5 5 5 5 5 5 . . . 
                . . . . 5 5 5 5 5 5 5 5 5 . . . 
                . . . . . 5 5 5 5 5 5 5 . . . . 
                . . . . . 5 5 5 5 5 5 5 . . . . 
                . . . . . . 5 5 5 5 5 . . . . . 
                . . . . 5 5 5 5 5 5 5 5 5 . . . 
                . . . 5 5 5 5 . . . 5 5 5 5 . . 
                `, SpriteKind.Food)
            hooked = false
        }
        hookedFish.setFlag(SpriteFlag.AutoDestroy, true)
    }
    if (hookedFish) {
        hookedFish.setPosition(hook.x - 4, hook.y + 75)
    }
})
// Checks how fast the player is cranking, sets the upper and lower bounds.
// 
// If you spend too long out of the safe range, the 'fightCounter' value increases and eventually you lose the fish.
//     
game.onUpdateInterval(150, function () {
    if (caught) {
        change = controller.crankPosition() - lastCrank
        lastCrank = controller.crankPosition()
        if (change < -5) {
            if (change > -10) {
                thisRound = "GOOD"
            } else if (change <= -10) {
                thisRound = "TOO FAST"
                fightCounter += 1
            }
        } else if (change >= -5) {
            thisRound = "TOO SLOW"
            fightCounter += 1
        }
        hookedFish.say(thisRound)
        if (fightCounter > 30) {
            gotAway = true
            hookedFish.destroy()
        }
    }
})
